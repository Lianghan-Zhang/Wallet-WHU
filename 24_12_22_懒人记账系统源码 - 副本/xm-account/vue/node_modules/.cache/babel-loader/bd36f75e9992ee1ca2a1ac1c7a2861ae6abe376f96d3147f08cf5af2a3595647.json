{"ast":null,"code":"export default {\n  name: \"PlanDetail\",\n  data() {\n    return {\n      tableData: [],\n      planId: this.$route.query.planId,\n      plan: {},\n      detailForm: {},\n      detailFromVisible: false,\n      rules: {\n        money: [{\n          required: true,\n          message: '请输入金额',\n          trigger: 'blur'\n        }, {\n          pattern: /^\\d+$/,\n          message: '请输入正整数',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created() {\n    this.load(); // 查询计划和详情列表\n  },\n\n  methods: {\n    load() {\n      this.$request.get('/plan/selectById/' + this.planId).then(res => {\n        this.plan = res.data || {};\n      });\n      this.$request.get('/planDetail/selectAll', {\n        params: {\n          planId: this.planId\n        }\n      }).then(res => {\n        this.tableData = res.data || [];\n      });\n    },\n    addPlanDetail(planId) {\n      this.detailFromVisible = true;\n      this.detailForm = {\n        planId: planId\n      };\n    },\n    savePlanDetail() {\n      this.$request.post('/planDetail/add', this.detailForm).then(res => {\n        if (res.code === '200') {\n          // 表示成功保存\n          this.$message.success('操作成功');\n          this.load();\n          this.detailFromVisible = false;\n        } else {\n          this.$message.error(res.msg); // 弹出错误的信息\n        }\n      });\n    },\n\n    del(id) {\n      // 单个删除\n      this.$confirm('您确定删除吗？', '确认删除', {\n        type: \"warning\"\n      }).then(response => {\n        this.$request.delete('/planDetail/delete/' + id).then(res => {\n          if (res.code === '200') {\n            // 表示操作成功\n            this.$message.success('操作成功');\n            this.load();\n          } else {\n            this.$message.error(res.msg); // 弹出错误的信息\n          }\n        });\n      }).catch(() => {});\n    }\n  }\n};","map":{"version":3,"names":["name","data","tableData","planId","$route","query","plan","detailForm","detailFromVisible","rules","money","required","message","trigger","pattern","created","load","methods","$request","get","then","res","params","addPlanDetail","savePlanDetail","post","code","$message","success","error","msg","del","id","$confirm","type","response","delete","catch"],"sources":["src/views/manager/PlanDetail.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"card\">\r\n      <div style=\"margin-bottom: 10px; display: flex; align-items: center\" >\r\n        <el-tag type=\"warning\" v-if=\"plan.status === '未开始'\">{{ plan.status }}</el-tag>\r\n        <el-tag type=\"primary\" v-if=\"plan.status === '进行中'\">{{ plan.status }}</el-tag>\r\n        <el-tag type=\"danger\" v-if=\"plan.status === '已结束'\">{{ plan.status }}</el-tag>\r\n        <el-tag type=\"success\" v-if=\"plan.status === '已完成'\">{{ plan.status }}</el-tag>\r\n        <div style=\"font-size: 20px; flex: 1; width: 0; margin-left: 5px\" class=\"line1\">{{ plan.name }}\r\n\r\n          <span style=\"color: red; font-size: 16px; font-weight: bold; margin-left: 10px\">￥{{ plan.money }}</span>\r\n\r\n          <el-button type=\"primary\" style=\"margin-left: 10px\" @click=\"addPlanDetail(planId)\">存一笔</el-button>\r\n        </div>\r\n        <div style=\"color: #666; margin-left: 20px; font-size: 13px; padding-right: 50px\"><i class=\"el-icon-date\"></i>  {{ plan.end }}</div>\r\n      </div>\r\n      <div style=\"margin-bottom: 10px\">\r\n        <el-progress :percentage=\"plan.percent\"></el-progress>\r\n      </div>\r\n    </div>\r\n\r\n    <div style=\"margin-top: 10px\">\r\n      <el-row :gutter=\"10\">\r\n        <el-col :span=\"6\" v-for=\"item in tableData\" :key=\"item.id\">\r\n          <div  class=\"card\" style=\"background-color: #fff1e0; margin-bottom: 10px\">\r\n            <div style=\"display: flex; align-items: center;  margin-bottom: 10px\">\r\n              <div style=\"color: #666; flex: 1\">存入 ￥{{ item.money }}</div>\r\n              <div style=\"display: flex; align-items: center\">累计 <span style=\"color: red; font-size: 20px\">{{ item.sum }}</span></div>\r\n            </div>\r\n\r\n            <div style=\"display: flex; color: #666; font-size: 13px\">\r\n              <div style=\"flex: 1\">{{ item.date }}</div>\r\n              <div @click=\"del(item.id)\" style=\"width: fit-content; cursor: pointer\"><i class=\"el-icon-delete\"></i><span>删除</span></div>\r\n            </div>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n    </div>\r\n\r\n    <el-dialog title=\"存钱\" :visible.sync=\"detailFromVisible\" width=\"30%\" :close-on-click-modal=\"false\" destroy-on-close>\r\n      <el-form :model=\"detailForm\" label-width=\"100px\" style=\"padding-right: 50px\" :rules=\"rules\" ref=\"formRef\">\r\n        <el-form-item label=\"金额\" prop=\"money\">\r\n          <el-input v-model=\"detailForm.money\" placeholder=\"金额\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"detailFromVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"savePlanDetail\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"PlanDetail\",\r\n  data() {\r\n    return {\r\n      tableData: [],\r\n      planId: this.$route.query.planId,\r\n      plan: {},\r\n      detailForm: {},\r\n      detailFromVisible: false,\r\n      rules: {\r\n        money: [\r\n          { required: true, message: '请输入金额', trigger: 'blur'},\r\n          { pattern: /^\\d+$/, message: '请输入正整数', trigger: 'blur'},\r\n        ],\r\n\r\n      },\r\n    }\r\n  },\r\n  created() {\r\n    this.load()   // 查询计划和详情列表\r\n  },\r\n  methods: {\r\n    load() {\r\n      this.$request.get('/plan/selectById/' + this.planId).then(res => {\r\n        this.plan = res.data || {}\r\n      })\r\n\r\n      this.$request.get('/planDetail/selectAll', { params: { planId: this.planId } }).then(res => {\r\n        this.tableData = res.data || []\r\n      })\r\n    },\r\n    addPlanDetail(planId) {\r\n      this.detailFromVisible = true\r\n      this.detailForm = { planId: planId }\r\n    },\r\n    savePlanDetail() {\r\n      this.$request.post('/planDetail/add', this.detailForm).then(res => {\r\n        if (res.code === '200') {  // 表示成功保存\r\n          this.$message.success('操作成功')\r\n          this.load()\r\n          this.detailFromVisible = false\r\n        } else {\r\n          this.$message.error(res.msg)  // 弹出错误的信息\r\n        }\r\n      })\r\n    },\r\n    del(id) {   // 单个删除\r\n      this.$confirm('您确定删除吗？', '确认删除', {type: \"warning\"}).then(response => {\r\n        this.$request.delete('/planDetail/delete/' + id).then(res => {\r\n          if (res.code === '200') {   // 表示操作成功\r\n            this.$message.success('操作成功')\r\n            this.load()\r\n          } else {\r\n            this.$message.error(res.msg)  // 弹出错误的信息\r\n          }\r\n        })\r\n      }).catch(() => {\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"],"mappings":"AAsDA;EACAA,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;MACAC,MAAA,OAAAC,MAAA,CAAAC,KAAA,CAAAF,MAAA;MACAG,IAAA;MACAC,UAAA;MACAC,iBAAA;MACAC,KAAA;QACAC,KAAA,GACA;UAAAC,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,OAAA;UAAAF,OAAA;UAAAC,OAAA;QAAA;MAGA;IACA;EACA;EACAE,QAAA;IACA,KAAAC,IAAA;EACA;;EACAC,OAAA;IACAD,KAAA;MACA,KAAAE,QAAA,CAAAC,GAAA,4BAAAhB,MAAA,EAAAiB,IAAA,CAAAC,GAAA;QACA,KAAAf,IAAA,GAAAe,GAAA,CAAApB,IAAA;MACA;MAEA,KAAAiB,QAAA,CAAAC,GAAA;QAAAG,MAAA;UAAAnB,MAAA,OAAAA;QAAA;MAAA,GAAAiB,IAAA,CAAAC,GAAA;QACA,KAAAnB,SAAA,GAAAmB,GAAA,CAAApB,IAAA;MACA;IACA;IACAsB,cAAApB,MAAA;MACA,KAAAK,iBAAA;MACA,KAAAD,UAAA;QAAAJ,MAAA,EAAAA;MAAA;IACA;IACAqB,eAAA;MACA,KAAAN,QAAA,CAAAO,IAAA,yBAAAlB,UAAA,EAAAa,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAK,IAAA;UAAA;UACA,KAAAC,QAAA,CAAAC,OAAA;UACA,KAAAZ,IAAA;UACA,KAAAR,iBAAA;QACA;UACA,KAAAmB,QAAA,CAAAE,KAAA,CAAAR,GAAA,CAAAS,GAAA;QACA;MACA;IACA;;IACAC,IAAAC,EAAA;MAAA;MACA,KAAAC,QAAA;QAAAC,IAAA;MAAA,GAAAd,IAAA,CAAAe,QAAA;QACA,KAAAjB,QAAA,CAAAkB,MAAA,yBAAAJ,EAAA,EAAAZ,IAAA,CAAAC,GAAA;UACA,IAAAA,GAAA,CAAAK,IAAA;YAAA;YACA,KAAAC,QAAA,CAAAC,OAAA;YACA,KAAAZ,IAAA;UACA;YACA,KAAAW,QAAA,CAAAE,KAAA,CAAAR,GAAA,CAAAS,GAAA;UACA;QACA;MACA,GAAAO,KAAA,QACA;IACA;EACA;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}